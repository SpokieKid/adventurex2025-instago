# InstaGo

一个Mac原生应用，支持在状态栏运行并提供全局悬浮窗，用于快速拖拽图片并上传到服务端处理，支持为图片添加文字标签。

## 功能特性

- 🖥️ **状态栏图标**: 启动后在状态栏显示图标，不占用Dock空间
- 🎈 **全局悬浮窗**: 可拖拽的悬浮窗，始终在最前层显示
- 📸 **拖拽上传**: 支持将图片文件拖拽到悬浮窗进行上传
- 🏷️ **文字标签**: 为上传的图片添加最多16个字符的标签/上下文信息
- 📝 **双重输入**: 支持状态栏菜单输入和悬浮窗展开输入
- 🌐 **服务端集成**: 自动将图片和标签发送到配置的服务端进行处理
- 💫 **视觉效果**: 使用现代化UI设计，支持动画展开/收缩

## 使用方法

### 运行应用

1. 在Xcode中打开项目
2. 选择"InstaGo"目标并运行
3. 应用启动后会在状态栏显示图标📷
4. 点击状态栏图标可以控制悬浮窗的显示/隐藏

### 文字标签功能

**状态栏输入**：
1. 点击状态栏图标打开菜单
2. 在"图片标签"输入框中输入文字（最多16字符）
3. 标签会自动同步到悬浮窗

**悬浮窗输入**：
1. 点击悬浮窗圆形按钮
2. 悬浮窗向左右展开，显示文字输入框
3. 输入完成后按回车键或等待自动收缩

### 拖拽上传

1. 悬浮窗会自动显示在屏幕上
2. 将图片文件拖拽到悬浮窗的圆形按钮区域
3. 应用会自动将图片和当前标签一起上传到服务端
4. 上传进度和结果会在悬浮窗中显示

### 内置服务器

应用现在集成了一个功能完整的 Go 服务器，具备以下特性：

- **自动启动**: 应用启动时自动启动内置服务器
- **图片分析**: 使用 AI 模型分析图片内容（可选）
- **语义搜索**: 基于向量数据库的图片语义搜索
- **文件夹管理**: 智能文件夹组织和管理
- **数据持久化**: SQLite 数据库存储，数据文件位于应用支持目录

服务器运行在 http://localhost:8080，您可以在状态栏菜单中查看服务器运行状态。

### 备用测试服务器

如果需要简单的测试环境，项目仍然包含一个 Python 测试服务器：

```bash
# 安装依赖
pip3 install -r requirements.txt

# 启动测试服务器（端口3000）
python3 test-server.py
```

## 应用控制

- **显示/隐藏悬浮窗**: 点击状态栏图标，选择相应选项
- **展开悬浮窗**: 点击悬浮窗圆形按钮
- **移动悬浮窗**: 直接拖拽悬浮窗到任意位置
- **输入标签**: 状态栏菜单或悬浮窗展开输入
- **退出应用**: 在状态栏菜单中选择"退出"

## 自定义配置

默认服务端地址为 `http://localhost:8080/upload`，应用启动时会自动启动内置的 Go 服务器。您可以在代码中修改 `AppState` 类的 `serverURL` 属性来配置自己的服务端地址。

## 服务端接口

服务端需要支持接收以下表单数据：
- `image`: 图片文件 (multipart/form-data)
- `label`: 文字标签 (text/plain)

## 系统要求

- macOS 12.0 或更高版本
- Xcode 14.0 或更高版本
- Swift 5.7 或更高版本

## 权限说明

应用需要以下权限：
- **文件访问**: 读取用户选择的图片文件
- **网络访问**: 上传图片和标签到服务端 